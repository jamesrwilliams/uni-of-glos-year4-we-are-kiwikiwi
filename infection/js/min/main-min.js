function drawHex(i,t,e){var s=1e-4,o=[[t+1*s,e+0],[t+3*s,e+0],[t+4*s,e+1*s*2.7],[t+3*s,e+2*s*2.7],[t+1*s,e+2*s*2.7],[t+0*s,e+1*s*2.7]];return o}function isNumber(i){return i==parseFloat(i)}function isEven(i){return isNumber(i)&&i%2===0}function isOdd(i){return isNumber(i)&&Math.abs(i)%2===1}function drawFences(t,e,s){var o=10,l=10,r=3e-4,a=27e-5;for(count=0;count<s.setup.height;count++)if(isEven(count))for(i=0;i<s.setup.width;i++)lat_offset=0*i,lng_offset=i*-54e-5,polygons.push(map.drawPolygon({paths:drawHex(1,t-r*count,e-lng_offset),strokeColor:s.grid.strokeColour,strokeOpacity:s.grid.strokeWeight,strokeWeight:.4,fillColor:s.style.fillColor,fillOpacity:s.style.fillOpactiy}));else if(isOdd(count))for(i=0;i<s.setup.width-1;i++)lat_offset=0*i,lng_offset=i*-54e-5,polygons.push(map.drawPolygon({paths:drawHex(1,t-r*count,e+a-lng_offset),strokeColor:s.grid.strokeColour,strokeOpacity:s.grid.strokeWeight,strokeWeight:s.grid.strokeOpacity,fillColor:s.style.fillColor,fillOpacity:s.style.fillOpactiy}))}function refreshMap(){$.ajax({type:"get",url:"http://www.jamesrwilliams.co.uk/hybrid/api.php?request=fetch_game",dataType:"json",success:function(i){initialise('"'===i.charAt(0)&&i.charAt(i.length-1)?JSON.parse(i.substring(1,i.length-1)):JSON.parse(i))},error:function(){console.log("Error")}})}function initialise(t){var e=t;polygons=[],map=new GMaps({zoom:18,div:"#map-canvas",lat:51.88718,lng:-2.088669,disableDefaultUI:!0});var s=[{featureType:"landscape",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",stylers:[{saturation:-100},{lightness:51},{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"road.arterial",stylers:[{saturation:-100},{lightness:30},{visibility:"on"}]},{featureType:"road.local",stylers:[{saturation:-100},{lightness:40},{visibility:"on"}]},{featureType:"transit",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"administrative.province",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"on"},{lightness:-25},{saturation:-100}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#ffff00"},{lightness:-25},{saturation:-97}]}];for(map.setOptions({styles:s}),drawFences(51.888094,-2.091802,e),i=0;i<polygons.length;i++)"1"==e.grid[i]?polygons[i].setOptions({fillColor:e.style.vampire,fillOpacity:.2,strokeWeight:.1}):"2"==e.grid[i]?polygons[i].setOptions({fillColor:e.style.werewolf,fillOpacity:.2,strokeWeight:.1}):"3"==e.grid[i]?polygons[i].setOptions({fillColor:e.style.ghost,fillOpacity:.2,strokeWeight:.1}):"4"==e.grid[i]?polygons[i].setOptions({fillColor:e.style.zombie,fillOpacity:.2,strokeWeight:.1}):polygons[i].setOptions({fillColor:"#FFFFFF",fillOpacity:.1,strokeWeight:.1})}var map,i,output,test_marker,polygons=[];